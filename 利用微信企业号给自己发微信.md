```
# -*- coding: utf-8 -*-

import wrapcache
import requests
import ujson as json


@wrapcache.wrapcache(timeout=7200)
def get_token():

    url='https://qyapi.weixin.qq.com/cgi-bin/gettoken'
    values = {
        'corpid' : '' ,
        'corpsecret':'',
    }
    req = requests.post(url, params=values)
    data = json.loads(req.text)
    return data["access_token"]

def send_msg(msg='you send nothing'):
    url="https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token="+get_token()
    print("url: ", url)
    values = {
        "touser": "tt67wq",
        "toparty": "1",
        "totag": "@all",
        "msgtype": "text",
        "agentid": 1,
        "text": {
            "content": msg
        },
        "safe":0
    }

    try:
        Session = requests.session()
        response = Session.post(url, data=json.dumps(values))
    except Exception as e:
        print(str(e))
    else:
        result = response.json()
        print(result)
    finally:
        Session.close()

if __name__ == '__main__':
    send_msg()
```
