```

# -*- coding: utf-8 -*-







import logging

import os

import logging.handlers







BLACK, RED, GREEN, YELLOW, BLUE, MAGENTA, CYAN, WHITE = range(8)



#The background is set with 40 plus the number of the color, and the foreground with 30



#These are the sequences need to get colored ouput

RESET_SEQ = "\033[0m"

COLOR_SEQ = "\033[1;%dm"

BOLD_SEQ = "\033[1m"



COLORS = {

    'WARNING': YELLOW,

    'INFO': WHITE,

    'DEBUG': BLUE,

    'CRITICAL': YELLOW,

    'ERROR': RED

}



class ColoredFormatter(logging.Formatter):

    def __init__(self, msg, use_color = True):

        logging.Formatter.__init__(self, msg)

        self.use_color = use_color



    def format(self, record):

        levelname = record.levelname

        if self.use_color and levelname in COLORS:

            levelname_color = COLOR_SEQ % (30 + COLORS[levelname]) + levelname + RESET_SEQ

            record.levelname = levelname_color

        return logging.Formatter.format(self, record)





class LogFactory:



    FORMAT = "[$BOLD%(name)-10s$RESET]  [%(levelname)-18s]  %(message)s ($BOLD%(filename)s$RESET:%(lineno)d)"



    def __init__(self, name=None, path="/tmp"):



        if os.path.exists(path):

            self.logfile = os.path.join(path, name+".log")

        else:

            self.logfile = os.path.join("/tmp", name+".log")

        self.name = name

        self.COLOR_FORMAT = self.formatter_message(self.FORMAT, True)





    def formatter_message(self, message, use_color=True):

        if use_color:

            message = message.replace("$RESET", RESET_SEQ).replace("$BOLD", BOLD_SEQ)

        else:

            message = message.replace("$RESET", "").replace("$BOLD", "")

        return message



    def make_logger(self):

        '''生产一个logger'''



        logger = logging.getLogger(self.name)



        color_formatter = ColoredFormatter(self.COLOR_FORMAT)



        stream_handler = logging.StreamHandler()

        file_handler = logging.handlers.RotatingFileHandler(self.logfile, maxBytes = 1024*1024*5, backupCount = 5)



        file_handler.setFormatter(color_formatter)

        stream_handler.setFormatter(color_formatter)



        logger.addHandler(file_handler)

        logger.addHandler(stream_handler)



        logger.setLevel("DEBUG")



        return logger





















if __name__ == "__main__":



    logger = LogFactory("hello").make_logger()

    logger.info("fuck you!")

    logger.warn("fuck you!")

    logger.debug("fuck you!")

    logger.error("fuck you!")

```
